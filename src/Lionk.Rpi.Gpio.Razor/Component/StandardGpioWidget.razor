@using Lionk.Core.Component
@using Lionk.Core.DataModel
@using MudBlazor
@using Lionk.Core
@namespace Lionk.Rpi.Gpio

<h3>StandardGpioWidget</h3>

@if (_value > 0)
{
    <MudChip T="string" Color="Color.Success">Active</MudChip>
}
else
{
    <MudChip T="string" Color="Color.Dark">Inactive</MudChip>

}

@code {
    // TODO ALEX pas sûr de ce que je fais ici si value est vraiment un int.
    private int _value = 0;

    [Parameter] public StandardIOGpio? Gpio { get; set; }

    protected override void OnInitialized()
    {
        base.OnInitialized();
        if (Gpio != null)
        {
            Gpio.NewValueAvailable += GpioNewValueAvailable;
        }
    }

    public void GpioNewValueAvailable(object? sender, MeasureEventArgs<int> e)
    {
        if (e is null) return;

        _value = e.Measures.First().Value;
        StateHasChanged();
    }
}
